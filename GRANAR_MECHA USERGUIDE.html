<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GRANAR-MECHA USERGUIDE</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="GRANAR_MECHA USERGUIDE_files/libs/clipboard/clipboard.min.js"></script>
<script src="GRANAR_MECHA USERGUIDE_files/libs/quarto-html/quarto.js"></script>
<script src="GRANAR_MECHA USERGUIDE_files/libs/quarto-html/popper.min.js"></script>
<script src="GRANAR_MECHA USERGUIDE_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="GRANAR_MECHA USERGUIDE_files/libs/quarto-html/anchor.min.js"></script>
<link href="GRANAR_MECHA USERGUIDE_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="GRANAR_MECHA USERGUIDE_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="GRANAR_MECHA USERGUIDE_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="GRANAR_MECHA USERGUIDE_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="GRANAR_MECHA USERGUIDE_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">GRANAR-MECHA USERGUIDE</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Adrien Heymans, Marco D’Agostino, Valentin Couvreur, Guillaume Lobet </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="what-is-granar" class="level1">
<h1>What is GRANAR?</h1>
<p>GRANAR stands for Generator of Root ANAtomy in R. The GRANAR model is able to generate complete cell networks of root cross-sections using a small set of root anatomical parameters These root anatomical features can typically be gathered using software image analysis such as <a href="https://imagej.net/Welcome">ImageJ</a> <span class="citation" data-cites="Schneider">(<a href="#ref-Schneider" role="doc-biblioref">Schneider, Rasband, and Eliceiri 2012</a>)</span>. Once the root anatomy is created, the cell network can be saved as an eXtended Markup Language (XML) file. The structure of the XML files created by GRANAR are identical to the ones created by <a href="https://www.nottingham.ac.uk/research/groups/cvl/software/cellset.aspx">CellSeT</a> <span class="citation" data-cites="Pound">(<a href="#ref-Pound" role="doc-biblioref">Pound et al. 2012</a>)</span> (a software which digitize root anatomical network).</p>
</section>
<section id="how-to-use-granar" class="level1">
<h1>How to use GRANAR?</h1>
<section id="load-functions" class="level2">
<h2 class="anchored" data-anchor-id="load-functions">Load functions</h2>
<p>GRANAR is available as an R package. The <em>‘granar’</em> package can be found on <a href="https://github.com/granar/granar">GitHub</a>. You can clone the repository with Github desktop and load all functions :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load GRANAR with local functions</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>granar_path <span class="ot">&lt;-</span> <span class="st">"../granar/R/"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">list.files</span>(granar_path)){</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(i)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source</span>(<span class="fu">paste0</span>(granar_path, i))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternatively, GRANAR can be installed localy by simply executing the following line in the <a href="https://cran.r-project.org/">R</a> environment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"granar/granar"</span>) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(granar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="run-granar" class="level2">
<h2 class="anchored" data-anchor-id="run-granar">Run GRANAR</h2>
<p>To run GRANAR, we use :</p>
<ul>
<li>The function <em>read_param_xml()</em> loads parameters from xml files</li>
<li>The function <em>create_anatomy()</em> generates the virtual cross section with input params</li>
<li>The function <em>plot_anatomy()</em> displays the generated anatomy</li>
</ul>
<section id="monocot-wheat" class="level3">
<h3 class="anchored" data-anchor-id="monocot-wheat">Monocot (wheat)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">read_param_xml</span>(<span class="at">path =</span> <span class="st">"Params/Wheat_F_Atkinson_2017.xml"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sim1 <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">create_anatomy</span>(<span class="at">parameters =</span> param1))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_anatomy</span>(sim1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="GRANAR_MECHA-USERGUIDE_files/figure-html/run%20GRANAR-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="primary-growth-dicot-tomato" class="level3">
<h3 class="anchored" data-anchor-id="primary-growth-dicot-tomato">Primary growth dicot (tomato)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> <span class="fu">read_param_xml</span>(<span class="at">path =</span> <span class="st">"Params/Tomato_primary.xml"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sim2 <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">create_anatomy</span>(<span class="at">parameters =</span> param2))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_anatomy</span>(sim2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRANAR_MECHA-USERGUIDE_files/figure-html/run%20GRANAR2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="secondary-growth-dicot-tomato" class="level3">
<h3 class="anchored" data-anchor-id="secondary-growth-dicot-tomato">Secondary growth dicot (tomato)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> <span class="fu">read_param_xml</span>(<span class="at">path =</span> <span class="st">"Params/Tomato_secondary.xml"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>sim3 <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">create_anatomy</span>(<span class="at">parameters =</span> param3))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_anatomy</span>(sim3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRANAR_MECHA-USERGUIDE_files/figure-html/run%20GRANAR3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To save virtual anatomies, we can use the function <em>write_anatomy_xml()</em> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_anatomy_xml</span>(<span class="at">sim =</span> sim1, <span class="at">path =</span> <span class="st">"Anatomies/Wheat.xml"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_anatomy_xml</span>(<span class="at">sim =</span> sim2, <span class="at">path =</span> <span class="st">"Anatomies/Tomato_primary.xml"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_anatomy_xml</span>(<span class="at">sim =</span> sim3, <span class="at">path =</span> <span class="st">"Anatomies/Tomato_secondary.xml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="mecha" class="level1">
<h1>MECHA</h1>
<p>MECHA is the solver of local conductivities (Couvreur 2018)</p>
<p>Set up steps to run it in local :</p>
<ol type="1">
<li><p>Open <strong>ANACONDA NAVIGATOR</strong></p></li>
<li><p>Create a new environment with <strong>python 3.7</strong> (in this work it is called <strong>GRANAR-MECHA</strong>)<br>
<code>conda create -n GRANAR-MECHA python=3.7</code></p></li>
<li><p>Load that environment</p>
<p><code>conda activate GRANAR-MECHA</code></p></li>
<li><p>Install MECHA requirements in the environement :<br>
<code>conda install numpy</code><br>
<code>conda install scipy</code><br>
<code>conda install matplotlib</code><br>
<code>conda install lxml</code><br>
<code>conda install pip</code><br>
<code>pip install networkx==1.9.1</code></p></li>
</ol>
<p>By default, MECHA loads the cross section named <em>current_root.xml</em> in the <em>cellsetdata</em> folder, so we need to copy the anatomy we created to that folder ;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>anatomy_file <span class="ot">&lt;-</span> <span class="st">"Tomato_primary.xml"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="at">from =</span> <span class="fu">paste0</span>(<span class="st">"Anatomies/"</span>, anatomy_file),<span class="at">to =</span> <span class="st">"MECHA/cellsetdata/"</span>, <span class="at">overwrite =</span> T)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">file.rename</span>(<span class="fu">paste0</span>(<span class="st">"MECHA/cellsetdata/"</span>, anatomy_file), <span class="st">"MECHA/cellsetdata/current_root.xml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By default, MECHA can simulate different scenarios : *</p>
<ul>
<li><p><strong>B0 : [Special case] No apoplastic barriers </strong></p></li>
<li><p><strong>B1 : Endodermal Casparian strip (radial walls)</strong></p></li>
<li><p><strong>B2 : Endodermal suberization except at passage cells</strong></p></li>
<li><p><strong>B3 : Endodermis full suberization</strong></p></li>
<li><p><strong>B4 : Endodermis full suberization and exodermal Casparian strip (radial walls)</strong></p></li>
<li><p><strong>B5 : Endo- and exodermal Casparian strips (radial walls)</strong></p></li>
<li><p><strong>B6 : Exodermis full suberization and endodermal Casparian strip (radial walls)</strong></p></li>
<li><p><strong>B7 : Exodermal Casparian strip (radial walls)</strong></p></li>
<li><p><strong>B8 : Endo and exodermal suberization</strong></p></li>
<li><p><strong>B9: Lignin Cap and endodermal CS</strong></p></li>
</ul>
<p>Here we choose to compute scenarios 1, 3 and 8. You can change the simulated scenarios in <em>MECHA/Projects/granar/in/Maize_Geometry.xml</em> in line 19.</p>
<p>Let’s run MECHA :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use_condaenv("GRANAR-MECHA")</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sys &lt;- import("sys", convert=T)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"MECHA/Projects/granar/out/Tomato/Root/Project_Test/results/"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">py_run_file</span>(<span class="st">"MECHA/MECHA_example.py"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can visualise the ratio of symplastiv vs.&nbsp;apoplastic flows for each scenario : nb ; Graphs are broken with Secondary Growth scenario</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>rp <span class="ot">&lt;-</span> <span class="st">"MECHA/Projects/granar/out/Tomato/Root/Project_Test/results/"</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Flux1 <span class="ot">&lt;-</span> <span class="fu">ApoSymp</span>(<span class="fu">paste0</span>(rp,<span class="st">"Macro_prop_1,0.txt"</span>)) <span class="co"># Endodermal CS</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>Flux2 <span class="ot">&lt;-</span> <span class="fu">ApoSymp</span>(<span class="fu">paste0</span>(rp,<span class="st">"Macro_prop_3,1.txt"</span>)) <span class="co"># Endodermis suberised</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>Flux3 <span class="ot">&lt;-</span> <span class="fu">ApoSymp</span>(<span class="fu">paste0</span>(rp,<span class="st">"Macro_prop_8,2.txt"</span>)) <span class="co"># Exo- and Endodermis fully suberised</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_water_flux</span>(Flux1, <span class="at">apobar =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRANAR_MECHA-USERGUIDE_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_water_flux</span>(Flux2, <span class="at">apobar =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRANAR_MECHA-USERGUIDE_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_water_flux</span>(Flux3, <span class="at">apobar =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRANAR_MECHA-USERGUIDE_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can load radial conductivity <span class="math inline">\(k_r\)</span> and axial conductance <span class="math inline">\(K_x\)</span> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>conds <span class="ot">&lt;-</span> <span class="fu">load_MECHA_out</span>()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(conds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 29%">
<col style="width: 33%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;">Kx</th>
<th style="text-align: center;">kr</th>
<th style="text-align: center;">perimeter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.02385859366092221</td>
<td style="text-align: center;">0.0001254278440673108</td>
<td style="text-align: center;">0.10262259718130115</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.02385859366092221</td>
<td style="text-align: center;">4.4759914335687034e-05</td>
<td style="text-align: center;">0.10262259718130115</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.02385859366092221</td>
<td style="text-align: center;">3.721398193800901e-05</td>
<td style="text-align: center;">0.10262259718130115</td>
</tr>
</tbody>
</table>
</div>
</div>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Pound" class="csl-entry" role="listitem">
Pound, Michael P, Andrew P French, Darren M Wells, Malcolm J Bennett, and Tony P Pridmore. 2012. <span>“<span>CellSeT</span>: Novel Software to Extract and Analyze Structured Networks of Plant Cells from Confocal Images.”</span> <em>Plant Cell</em> 24 (4): 1353–61.
</div>
<div id="ref-Schneider" class="csl-entry" role="listitem">
Schneider, Caroline A, Wayne S Rasband, and Kevin W Eliceiri. 2012. <span>“<span>NIH</span> Image to <span>ImageJ</span>: 25 Years of Image Analysis.”</span> <em>Nat. Methods</em> 9 (7): 671–75.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>